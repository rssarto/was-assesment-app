package waes.assesment.integration;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import waes.assesment.resources.dto.DiffDataDTO;
import waes.assesment.services.DiffService;
import waes.assesment.services.DiffServiceImpl;
import waes.assesment.services.InMemoryDiffStorageImpl;

import java.util.UUID;

import static org.assertj.core.api.Assertions.assertThat;

@SpringBootTest(classes = {DiffServiceImpl.class, InMemoryDiffStorageImpl.class})
class DiffServiceImplTest {

    @Autowired
    private DiffService diffService;

    @Test
    public void startContext(){}

    @Test
    public void createDiffData(){
        final String base64WaesLogoV2 = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxERDhUQEA8TEhIXEBETGBEXGBAQERkWGBEWGRkXFRcYHCggGRoxHBYXITEtJSo3LjouFx8zPT8sOCgtLisBCgoKDg0OGRAQGzcgICYvLTctNysrLTcvNysrNy0wNzU1NystKzAuNzUyKy0uLS42Kzc1LSstNy0rKy4tLy0tOP/AABEIAMgAyAMBIgACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAABwgEBQYDAQL/xABKEAABAwICBgYFCAYHCQAAAAABAAIDBBEFEgYHEyExUSJBYXGBkRQXQpPTCDJSVYKSocFDVGJjg6MWIyRyotHwFTNTZHOxs8LS/8QAGgEBAAIDAQAAAAAAAAAAAAAAAAMFAQIEBv/EACgRAQACAgECBQMFAAAAAAAAAAABAgMRBBIxBSEiQVETYaEUMoHh8P/aAAwDAQACEQMRAD8Ag1ERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERARdpqkwimrMXjpquLaxOjm6GZ7Ok1hcDdhB6ip59UuCfV497VfEQVSRWkxHVTgzYJHNoAHCJ5B2tUbENNv0iq2gIp51T6sqKowtlTX021kle57LvmjyxXyt3McL3sXdzgu09UuCfV497VfEQVSRd5rl0epqDExDSxbKJ1NHJkzPfvL3tJu8k+ysbVRowzEcUZDKzNAxj5ZW3c27Wiwbdpvvc5vhdBxiK1vqlwT6vHvar4ieqXBPq8e9qviIKpIul0opIJ8Xkp8MgyxGcQQxtc9+YghubM8k2LrnuIU94PqewqOmjZUUu3mDBtJdpUMzP8AaIDXgAX4buCCsC+K1nqmwT6vHvav4i0mmmrPCIMMqpoaMMljpppGP2tSbOawkbnPsUNq3IsvC6Mz1EUDeMk0cY73vDfzVofVLgn1ePe1fxEFU0VrfVLgn1ePe1XxE9UuCfV497VfEQVSRWt9UuCfV497VfEUD6yMDhjxx9Dh1OQBsY2xNMkhdI6NrjbMSb3dbwQcUin7Q3UfCxjZcTeZZCAfR2OL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BSlERB9VzNE5tphtLJ9KjpnecLT+apmrAaK60qGHC6amNU2KaOnjjeXx1Lw0taBuEbDm4cwsxG2trajaWaytjhbnleGN5n8ua4fSHTwtY7YDIxrXEyuHSsBc5Wnh4rR/0wwGR+0qsWkndy2NWxncAI93gVo9ZmnWGPww0uFva6SV7WyOEc0REQ6R6UjQSSQ0dxK6KThp39U/hwZKcrNOonor+f6RFi9e+oqJJ5HFz3vLiSSTvPMqXtEtSvpFPFU1NaQyWKOURxNBdlewOF3v4Gx+iVCqsjofrRwmHDaWGesySx0sEb27KqdZzI2tIu2Mg8Opc+1h0xrToME1aYVS2LaRsrx7c39cfJ3RB7gms/EvRMHmETbPkApo2tAHSl6JDbcDlzHwWP63ME/X/wCTWfDXG6c6f4ZWTwCOrBiizvuY6ho2juiCQY79FoPV+k7Ftjr1WiJnSLPeceObVjc/ENVgGGCmp2x8XcXHm48f8vBdTgujk9SQQMkf/Edw+yOtY2C6V6PxWdNXiV/Iw1mzHcNnv8fwXQz63cFbG5zKwvcGuLYxFVNLiBuaC6OwJ4b9yssnOrSvRij+VFg8Hvlv9Xkz39myoxhdA8skq6Zs4AzbWWFkouL/ADXHoixWy/pdhv1lR+/p/wD6VRsaxOSqqZamY3klkc93K5PAdgG4dgWCqy17Wndp2v8AFipir00jULR6wq8OfHE03AbtCRvBzbm28L+a49ao6Z0UzmmSpDOhG0ksnIAaxrd+Vh5dS6bCNK9HYbOlr9s/tgq8g7m7P/urfHyMWDFEb3P2eXzcHkcvk2trUb7z8I+pNAa/EK2UwQlsW2f/AF8nQhF3dR4u+yCpY0R1RUNJaSo/tkw33eAIQf2Y+B+1fwWa3W1gYFhX/wAmr+GvvrcwT9f/AJNZ8NVNrbmZeox4+msRPm7ZjQAAAAALADcLcgv2uG9buCfr/wDJrPhp63cE/X/5NZ8NaJHcooF1sazopfRThNa/PHLJI97WzRWOVoYCJGjOCC/dvHNZ2ievVhAjxKAtduHpEIzNPa+Mm4+yT3BBNi+ALmsO0/wqcAx4jTi/U94gd92SxWVU6YYbGLvxGlH8aEnwANyg3ijzXVpSyjwx8DXDb1LXRNb1iMi0jz2ZTbvcORWs0r13UUDS2haaqW255Do4Ae0mzndwHioEx/G6iuqHVNVIZJHdfBoHU1o9lo5INaiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiD//2Q==";
        final UUID diffId = UUID.randomUUID();
        final DiffDataDTO diffDataDTO = new DiffDataDTO(base64WaesLogoV2);
        this.diffService.create(diffId, diffDataDTO);
        this.diffService.findByd(diffId);
    }

    @Test
    public void duplicateDiffData_shouldThrowException(){
        final String base64WaesLogoV2 = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxERDhUQEA8TEhIXEBETGBEXGBAQERkWGBEWGRkXFRcYHCggGRoxHBYXITEtJSo3LjouFx8zPT8sOCgtLisBCgoKDg0OGRAQGzcgICYvLTctNysrLTcvNysrNy0wNzU1NystKzAuNzUyKy0uLS42Kzc1LSstNy0rKy4tLy0tOP/AABEIAMgAyAMBIgACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAABwgEBQYDAQL/xABKEAABAwICBgYFCAYHCQAAAAABAAIDBBEFEgYHEyExUSJBYXGBkRQXQpPTCDJSVYKSocFDVGJjg6MWIyRyotHwFTNTZHOxs8LS/8QAGgEBAAIDAQAAAAAAAAAAAAAAAAMFAQIEBv/EACgRAQACAgECBQMFAAAAAAAAAAABAgMRBBIxBSEiQVETYaEUMoHh8P/aAAwDAQACEQMRAD8Ag1ERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERAREQEREBERARdpqkwimrMXjpquLaxOjm6GZ7Ok1hcDdhB6ip59UuCfV497VfEQVSRWkxHVTgzYJHNoAHCJ5B2tUbENNv0iq2gIp51T6sqKowtlTX021kle57LvmjyxXyt3McL3sXdzgu09UuCfV497VfEQVSRd5rl0epqDExDSxbKJ1NHJkzPfvL3tJu8k+ysbVRowzEcUZDKzNAxj5ZW3c27Wiwbdpvvc5vhdBxiK1vqlwT6vHvar4ieqXBPq8e9qviIKpIul0opIJ8Xkp8MgyxGcQQxtc9+YghubM8k2LrnuIU94PqewqOmjZUUu3mDBtJdpUMzP8AaIDXgAX4buCCsC+K1nqmwT6vHvav4i0mmmrPCIMMqpoaMMljpppGP2tSbOawkbnPsUNq3IsvC6Mz1EUDeMk0cY73vDfzVofVLgn1ePe1fxEFU0VrfVLgn1ePe1XxE9UuCfV497VfEQVSRWt9UuCfV497VfEUD6yMDhjxx9Dh1OQBsY2xNMkhdI6NrjbMSb3dbwQcUin7Q3UfCxjZcTeZZCAfR2OL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BSlERB9VzNE5tphtLJ9KjpnecLT+apmrAaK60qGHC6amNU2KaOnjjeXx1Lw0taBuEbDm4cwsxG2trajaWaytjhbnleGN5n8ua4fSHTwtY7YDIxrXEyuHSsBc5Wnh4rR/0wwGR+0qsWkndy2NWxncAI93gVo9ZmnWGPww0uFva6SV7WyOEc0REQ6R6UjQSSQ0dxK6KThp39U/hwZKcrNOonor+f6RFi9e+oqJJ5HFz3vLiSSTvPMqXtEtSvpFPFU1NaQyWKOURxNBdlewOF3v4Gx+iVCqsjofrRwmHDaWGesySx0sEb27KqdZzI2tIu2Mg8Opc+1h0xrToME1aYVS2LaRsrx7c39cfJ3RB7gms/EvRMHmETbPkApo2tAHSl6JDbcDlzHwWP63ME/X/wCTWfDXG6c6f4ZWTwCOrBiizvuY6ho2juiCQY79FoPV+k7Ftjr1WiJnSLPeceObVjc/ENVgGGCmp2x8XcXHm48f8vBdTgujk9SQQMkf/Edw+yOtY2C6V6PxWdNXiV/Iw1mzHcNnv8fwXQz63cFbG5zKwvcGuLYxFVNLiBuaC6OwJ4b9yssnOrSvRij+VFg8Hvlv9Xkz39myoxhdA8skq6Zs4AzbWWFkouL/ADXHoixWy/pdhv1lR+/p/wD6VRsaxOSqqZamY3klkc93K5PAdgG4dgWCqy17Wndp2v8AFipir00jULR6wq8OfHE03AbtCRvBzbm28L+a49ao6Z0UzmmSpDOhG0ksnIAaxrd+Vh5dS6bCNK9HYbOlr9s/tgq8g7m7P/urfHyMWDFEb3P2eXzcHkcvk2trUb7z8I+pNAa/EK2UwQlsW2f/AF8nQhF3dR4u+yCpY0R1RUNJaSo/tkw33eAIQf2Y+B+1fwWa3W1gYFhX/wAmr+GvvrcwT9f/AJNZ8NVNrbmZeox4+msRPm7ZjQAAAAALADcLcgv2uG9buCfr/wDJrPhp63cE/X/5NZ8NaJHcooF1sazopfRThNa/PHLJI97WzRWOVoYCJGjOCC/dvHNZ2ievVhAjxKAtduHpEIzNPa+Mm4+yT3BBNi+ALmsO0/wqcAx4jTi/U94gd92SxWVU6YYbGLvxGlH8aEnwANyg3ijzXVpSyjwx8DXDb1LXRNb1iMi0jz2ZTbvcORWs0r13UUDS2haaqW255Do4Ae0mzndwHioEx/G6iuqHVNVIZJHdfBoHU1o9lo5INaiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiAiIgIiICIiD//2Q==";
        final UUID diffId = UUID.randomUUID();
        final DiffDataDTO diffDataDTO = new DiffDataDTO(base64WaesLogoV2);
        this.diffService.create(diffId, diffDataDTO);
        this.diffService.findByd(diffId);

        RuntimeException illegalArgumentException = Assertions.assertThrows(
                IllegalArgumentException.class,
                () -> {
                    this.diffService.create(diffId, diffDataDTO);
                },
                "Exception was not thrown."
        );

        assertThat(illegalArgumentException.getMessage()).isEqualTo(String.format("The id %s already exists, please use another id.", diffId));
    }

}