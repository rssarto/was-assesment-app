package waes.assesment.integration;

import org.apache.commons.collections4.CollectionUtils;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import waes.assesment.exceptions.RecordAlreadyExistsException;
import waes.assesment.exceptions.RecordNotFoundException;
import waes.assesment.resources.dto.ChangeLog;
import waes.assesment.resources.dto.DiffDataDTO;
import waes.assesment.resources.dto.DiffResultDTO;
import waes.assesment.resources.enums.DataType;
import waes.assesment.services.DiffService;
import waes.assesment.services.DiffServiceImpl;
import waes.assesment.services.InMemoryDiffStorageImpl;
import waes.assesment.unit.controllers.BinaryDiffControllerTest;

import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

import static org.assertj.core.api.Assertions.assertThat;

@SpringBootTest(classes = {DiffServiceImpl.class, InMemoryDiffStorageImpl.class})
public class DiffServiceImplTest {

    @Autowired
    private DiffService diffService;

    @Test
    @DisplayName("Create new record")
    public void createDiffData(){
        final UUID diffId = UUID.randomUUID();
        final DiffDataDTO diffDataDTO = new DiffDataDTO(BinaryDiffControllerTest.BASE64_WAES_LOGO_V2, DataType.LEFT);
        this.diffService.create(diffId, diffDataDTO);
        this.diffService.findByd(diffId);
    }

    @Test
    @DisplayName("Duplicate record - should throw exception")
    public void duplicateDiffData_shouldThrowException(){
        final UUID diffId = UUID.randomUUID();
        final DiffDataDTO diffDataDTO = new DiffDataDTO(BinaryDiffControllerTest.BASE64_WAES_LOGO_V2, DataType.LEFT);
        this.diffService.create(diffId, diffDataDTO);
        this.diffService.findByd(diffId);

        RecordAlreadyExistsException recordAlreadyExistsException = Assertions.assertThrows(
                RecordAlreadyExistsException.class,
                () -> {
                    this.diffService.create(diffId, diffDataDTO);
                },
                "Exception was not thrown."
        );

        assertThat(recordAlreadyExistsException.getMessage()).isEqualTo(String.format("The id %s already exists, please use another id.", diffId));
    }

    @Test
    @DisplayName("Find Diff Data by Id")
    public void findDiffData(){
        final UUID diffId = UUID.randomUUID();
        final DiffDataDTO diffDataDTO = new DiffDataDTO(BinaryDiffControllerTest.BASE64_WAES_LOGO_V2, DataType.LEFT);
        this.diffService.create(diffId, diffDataDTO);
        this.diffService.findByd(diffId);
    }

    @Test
    @DisplayName("Diff data not found - should Throw Exception")
    public void notFoundDiffData_shouldThrowException(){
        final UUID diffId = UUID.randomUUID();

        RecordNotFoundException recordNotFoundException = Assertions.assertThrows(
                RecordNotFoundException.class,
                () -> {
                    this.diffService.findByd(diffId);
                },
                "Exception was not thrown."
        );

        assertThat(recordNotFoundException.getMessage()).isEqualTo(String.format("The id %s was not found", diffId.toString()));
    }

    @Test
    @DisplayName("Compare not equal size data")
    public void compareNotEqualSizeData_shouldReturnDataIsNotEqual(){
        final UUID diffId = UUID.randomUUID();
        final DiffDataDTO leftDiffDataDTO = new DiffDataDTO(BinaryDiffControllerTest.BASE64_WAES_LOGO_V2, DataType.LEFT);
        this.diffService.create(diffId, leftDiffDataDTO);

        final DiffDataDTO rightDiffDataDTO = new DiffDataDTO(BinaryDiffControllerTest.BASE64_WAES_LOGO, DataType.RIGHT);
        this.diffService.create(diffId, rightDiffDataDTO);

        final DiffResultDTO diffResultDTO = this.diffService.compare(diffId);
        assertThat(diffResultDTO).isNotNull();
        assertThat(diffResultDTO.getDataSizeMap()).isNotNull();
        assertThat(diffResultDTO.isEqual()).isFalse();
        assertThat(diffResultDTO.getDataSizeMap().size()).isEqualTo(2);
        assertThat(diffResultDTO.getDataSizeMap().get(DataType.LEFT)).isEqualTo(BinaryDiffControllerTest.BASE64_WAES_LOGO_V2.length());
        assertThat(diffResultDTO.getDataSizeMap().get(DataType.RIGHT)).isEqualTo(BinaryDiffControllerTest.BASE64_WAES_LOGO.length());
    }

    @Test
    @DisplayName("Compare equal data")
    public void compareEqualData(){
        final UUID diffId = UUID.randomUUID();
        final DiffDataDTO leftDiffDataDTO = new DiffDataDTO(BinaryDiffControllerTest.BASE64_WAES_LOGO, DataType.LEFT);
        this.diffService.create(diffId, leftDiffDataDTO);

        final DiffDataDTO rightDiffDataDTO = new DiffDataDTO(BinaryDiffControllerTest.BASE64_WAES_LOGO, DataType.RIGHT);
        this.diffService.create(diffId, rightDiffDataDTO);

        final DiffResultDTO diffResultDTO = this.diffService.compare(diffId);
        assertThat(diffResultDTO).isNotNull();
        assertThat(diffResultDTO.getDiffMap()).isNotNull();
        assertThat(diffResultDTO.getDataSizeMap()).isNull();
        assertThat(diffResultDTO.getDiffMap().size()).isEqualTo(2);
        assertThat(diffResultDTO.isEqual()).isTrue();
    }

    @Test
    @DisplayName("Compare data with same size but not equal data")
    public void compareNotEqualData(){
        final UUID diffId = UUID.randomUUID();
        final List<ChangeLog> expectedChangeLogList = new ArrayList<>();
        expectedChangeLogList.add(new ChangeLog(79, 1));
        expectedChangeLogList.add(new ChangeLog(3023, 8));
        expectedChangeLogList.add(new ChangeLog(10407, 20));

        final DiffDataDTO leftDiffDataDTO =
                new DiffDataDTO("data:image/png;base64,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", DataType.LEFT);
        this.diffService.create(diffId, leftDiffDataDTO);

        final DiffDataDTO rightDiffDataDTO =
                new DiffDataDTO("data:image/png;base64,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", DataType.RIGHT);
                /*                                                                                                   ^                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^-------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ^-------------------                                               */
        this.diffService.create(diffId, rightDiffDataDTO);

        final DiffResultDTO diffResultDTO = this.diffService.compare(diffId);
        assertThat(diffResultDTO).isNotNull();

        assertThat(CollectionUtils.isNotEmpty(diffResultDTO.getChangeLogList())).isTrue();
        assertThat(diffResultDTO.getChangeLogList().size()).isEqualTo(expectedChangeLogList.size());
        assertThat(diffResultDTO.getChangeLogList()).isEqualTo(expectedChangeLogList);
        assertThat(diffResultDTO.getDataSizeMap()).isNull();
        assertThat(diffResultDTO.getDiffMap()).isNotNull();
        assertThat(diffResultDTO.getDiffMap().size()).isEqualTo(2);
        assertThat(diffResultDTO.isEqual()).isFalse();
    }

}